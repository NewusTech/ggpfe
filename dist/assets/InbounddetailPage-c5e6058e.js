import{m as q,a as J,u as K,r as m,n as Q,l as H,j as x,d as u,o as _,e as f,g as s,s as o,f as e,t as l,F as W,v as D,z as X,A as E,y as r,x as Y}from"./index-2eb3e8c7.js";const Z=["href","onClick"],ee={class:"text-primary font-semibold"},te=["href","target"],oe={class:"text-color"},se={class:"grid"},le={class:"col-12"},ae={class:"card"},ne={class:"my-1"},de={class:"m-0"},ce={class:"my-1"},ie={class:"m-0",style:{color:"black"}},re={key:0,style:{color:"green"}},me={key:1,class:"text-primary"},ue={class:"grid grid-nogutter"},_e={class:"col-12 md:col-7 lg:col-7 grid grid-nogutter"},he=e("div",{class:"px-3 py-1 col-6 md:col-4 lg:col-4"},[e("small",null,"Inbound Date")],-1),ye={class:"px-3 py-1 col-6 md:col-8 lg:col-8"},pe={class:"col-12 md:col-5 lg:col-5 grid grid-nogutter"},fe=e("div",{class:"px-3 py-1 col-6 md:col-5 lg:col-5"},[e("small",null,"Storage Location")],-1),ge={class:"px-3 py-1 col-6 md:col-7 lg:col-7"},ve={class:"col-12 md:col-7 lg:col-7 grid grid-nogutter"},xe=e("div",{class:"px-3 py-1 col-6 md:col-4 lg:col-4"},[e("small",null,"Reference Doc")],-1),we={class:"px-3 py-1 col-6 md:col-8 lg:col-8"},be={class:"col-12 md:col-5 lg:col-5 grid grid-nogutter"},ke=e("div",{class:"px-3 py-1 col-6 md:col-5 lg:col-5"},[e("small",null,"From")],-1),je={class:"px-3 py-1 col-6 md:col-7 lg:col-7"},Se={class:"col-12 md:col-7 lg:col-7 grid grid-nogutter"},Te=e("div",{class:"px-3 py-1 col-6 md:col-4 lg:col-4"},[e("small",null,"Type")],-1),Be={class:"px-3 py-1 col-6 md:col-8 lg:col-8"},Ce=e("div",{class:"col-12 md:col-5 lg:col-5 grid grid-nogutter"},null,-1),Ie=e("div",{class:"flex flex-column md:flex-row md:justify-content-between md:align-items-center",style:{"text-align":"center",width:"100%"}},[e("span",{style:{width:"100%"}},"No")],-1),De=e("div",{class:"flex flex-column md:flex-row md:justify-content-between md:align-items-center",style:{"text-align":"center",width:"90%"}},[e("span",{style:{width:"100%"}},"Material Code")],-1),Ee=e("div",{class:"flex flex-column md:flex-row md:justify-content-between md:align-items-center",style:{"text-align":"center",width:"90%"}},[e("span",{style:{width:"100%"}},"Material Description")],-1),Pe=e("div",{class:"flex flex-column md:flex-row md:justify-content-between md:align-items-center",style:{"text-align":"center",width:"90%"}},[e("span",{style:{width:"100%"}},"Item")],-1),Ae=e("div",{class:"flex flex-column md:flex-row md:justify-content-between md:align-items-center",style:{"text-align":"center",width:"90%"}},[e("span",{style:{width:"100%"}},"Plant")],-1),$e=e("div",{class:"flex flex-column md:flex-row md:justify-content-between md:align-items-center",style:{"text-align":"center",width:"90%"}},[e("span",{style:{width:"100%"}},"Qty")],-1),Fe=e("div",{class:"flex flex-column md:flex-row md:justify-content-between md:align-items-center",style:{"text-align":"center",width:"90%"}},[e("span",{style:{width:"100%"}},"UoM")],-1),Ue=e("div",{class:"flex flex-column md:flex-row md:justify-content-between md:align-items-center",style:{"text-align":"center",width:"90%"}},[e("span",{style:{width:"100%"}},"Batch")],-1),ze=e("div",{class:"flex flex-column md:flex-row md:justify-content-between md:align-items-center",style:{"text-align":"center",width:"90%"}},[e("span",{style:{width:"100%"}},"Storage Bin")],-1),Me=e("div",{class:"flex flex-column md:flex-row md:justify-content-between md:align-items-center",style:{"text-align":"center",width:"90%"}},[e("span",{style:{width:"100%"}},"Status")],-1),Ne={key:0,style:{color:"green"}},Re={key:1,class:"text-primary"},Oe=e("div",{class:"my-5"},null,-1),Le={__name:"InbounddetailPage",setup(Ve){q();const P=J(),v=K(),y=m(null),A=m(null),n=m({}),$=m(null),F=m({}),U=m(null),w=m(null),z=m([{label:"Inbound",route:"/inbound"},{label:"Detail"}]);Q(async()=>{});const M=async()=>{try{const a=`${x}/api/inbound/${w.value}`,d=await fetch(a,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`}}),c=await d.json();if(d.ok)n.value=c.data;else throw new Error(c.error||"Failed to fetch data from API")}catch{v.add({severity:"error",summary:"Error",detail:"Failed to fetch data from API",life:5e3})}};H(async()=>{w.value=P.currentRoute.value.params.id;try{const d=await(await fetch(`${x}/api/auth/get_user/`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`}})).json();A.value=d.data.departement_id;const c=`${x}/api/inbound/${w.value}`,h=await fetch(c,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`}}),p=await h.json();if(h.ok)n.value=p.data;else throw new Error(p.error||"Failed to fetch data from API")}catch{v.add({severity:"error",summary:"Error",detail:"Failed to fetch data from API",life:5e3})}});const N=a=>{if(a){const d=new Date(a),c={year:"numeric",month:"2-digit",day:"2-digit"};return d.toLocaleDateString(void 0,c)}else return"-"},R=async()=>{try{const a=y.value.map(p=>p.id),d=`${x}/api/inbound/release`,c=await fetch(d,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify({selectedIds:a})}),h=await c.json();if(c.ok)y.value=[],M(),v.add({severity:"success",summary:"Success",detail:h.message,life:5e3});else throw new Error(h.error||"Failed to release data")}catch(a){console.error("Error releasing data:",a),v.add({severity:"error",summary:"Error",detail:"Failed to release data",life:5e3})}};return(a,d)=>{var j,S,T,B,C,I;const c=u("router-link"),h=u("Breadcrumb"),p=u("Toast"),b=u("Toolbar"),k=u("Divider"),O=u("Button"),i=u("Column"),V=u("DataTable");return _(),f(W,null,[s(h,{model:z.value},{item:o(({item:t,props:g})=>[t.route?(_(),D(c,{key:0,to:t.route,custom:""},{default:o(({href:G,navigate:L})=>[e("a",E({href:G},g.action,{onClick:L}),[e("span",{class:X([t.icon,"text-color"])},null,2),e("span",ee,l(t.label),1)],16,Z)]),_:2},1032,["to"])):(_(),f("a",E({key:1,href:t.url,target:t.target},g.action),[e("span",oe,l(t.label),1)],16,te))]),_:1},8,["model"]),e("div",se,[e("div",le,[e("div",ae,[s(p),s(b,{class:"mb-4 p-0",style:{border:"none","background-color":"white"}},{start:o(()=>{var t;return[e("div",ne,[e("h5",de,l((t=n.value[0])==null?void 0:t.code),1)])]}),end:o(()=>{var t,g;return[e("div",ce,[e("p",ie,[r("Status : "),((t=n.value[0])==null?void 0:t.status)==2||((g=n.value[0])==null?void 0:g.status)==9?(_(),f("span",re,"Complete")):(_(),f("span",me,"On Progress"))])])]}),_:1}),s(k),e("div",ue,[e("div",_e,[he,e("div",ye,[e("small",null,": "+l(N((j=n.value[0])==null?void 0:j.date)),1)])]),e("div",pe,[fe,e("div",ge,[e("small",null,": "+l((S=n.value[0])==null?void 0:S.s_loc),1)])]),e("div",ve,[xe,e("div",we,[e("small",null,": "+l((T=n.value[0])==null?void 0:T.ref_code),1)])]),e("div",be,[ke,e("div",je,[e("small",null,": "+l((B=n.value[0])==null?void 0:B.from),1)])]),e("div",Se,[Te,e("div",Be,[e("small",null,": "+l((C=n.value[0])==null?void 0:C.ref_type),1)])]),Ce]),s(k,{class:"mb-5"}),s(b,{class:"bg-white border-none"},{end:o(()=>[y.value&&y.value.length?(_(),D(O,{key:0,label:"Release to SAP",class:"p-button-primary",onClick:R})):Y("",!0)]),_:1}),s(V,{ref_key:"dt",ref:$,value:(I=n.value[0])==null?void 0:I.inbound_material,selection:y.value,"onUpdate:selection":d[0]||(d[0]=t=>y.value=t),filters:F.value,loading:U.value,dataKey:"id",class:"p-datatable-gridlines",rows:10,responsiveLayout:"scroll"},{default:o(()=>[s(i,{selectionMode:"multiple",headerStyle:"width:3%"}),s(i,{field:"rowIndex",style:{"text-align":"center"}},{header:o(()=>[Ie]),body:o(t=>[r(l(t.index+1),1)]),_:1}),s(i,{field:"material_code"},{header:o(()=>[De]),body:o(t=>[r(l(t.data.material_code),1)]),_:1}),s(i,{field:"material_description"},{header:o(()=>[Ee]),body:o(t=>[r(l(t.data.material_description),1)]),_:1}),s(i,{field:"item"},{header:o(()=>[Pe]),body:o(t=>[r(l(t.data.item),1)]),_:1}),s(i,{field:"plant"},{header:o(()=>[Ae]),body:o(t=>[r(l(t.data.plant),1)]),_:1}),s(i,{field:"qty"},{header:o(()=>[$e]),body:o(t=>[r(l(t.data.qty),1)]),_:1}),s(i,{field:"uom"},{header:o(()=>[Fe]),body:o(t=>[r(l(t.data.uom),1)]),_:1}),s(i,{field:"batch"},{header:o(()=>[Ue]),body:o(t=>[r(l(t.data.batch),1)]),_:1}),s(i,{field:"s_bin"},{header:o(()=>[ze]),body:o(t=>[r(l(t.data.s_bin),1)]),_:1}),s(i,{field:"status"},{header:o(()=>[Me]),body:o(t=>[t.data.status==2||t.data.status==9?(_(),f("p",Ne,"Complete")):(_(),f("p",Re,"On Progress"))]),_:1})]),_:1},8,["value","selection","filters","loading"]),Oe])])])],64)}}};export{Le as default};
