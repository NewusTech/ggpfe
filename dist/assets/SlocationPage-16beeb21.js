import{m as le,r as m,u as se,n as oe,l as ie,j as D,q as ne,d as S,o as r,e as c,f as l,g as d,s as o,v as N,x as f,y,t as v,z as b}from"./index-2eb3e8c7.js";const de={class:"grid mt-1"},re={class:"col-12"},ue={class:"card"},ce=l("div",{class:"my-2"},[l("h5",{class:"m-0"},"Master Storage Location")],-1),ve={class:"flex flex-column md:flex-row md:justify-content-between md:align-items-center"},me={class:"block mt-2 md:mt-0 p-input-icon-left"},_e=l("i",{class:"pi pi-search"},null,-1),pe=l("div",{class:"flex flex-column md:flex-row md:justify-content-between md:align-items-center",style:{"text-align":"center",width:"100%"}},[l("span",{style:{width:"100%"}},"No")],-1),he=l("div",{class:"flex flex-column md:flex-row md:justify-content-between md:align-items-center",style:{"text-align":"center",width:"90%"}},[l("span",{style:{width:"100%"}},"Storage Location")],-1),be=l("div",{class:"flex flex-column md:flex-row md:justify-content-between md:align-items-center",style:{"text-align":"center",width:"90%"}},[l("span",{style:{width:"100%"}},"Description")],-1),fe=l("div",{class:"flex flex-column md:flex-row md:justify-content-between md:align-items-center",style:{"text-align":"center",width:"90%"}},[l("span",{style:{width:"100%"}},"Plant")],-1),ye=l("div",{class:"flex flex-column md:flex-row md:justify-content-between md:align-items-center",style:{"text-align":"center",width:"90%"}},[l("span",{style:{width:"100%"}},"Inbound")],-1),we=l("div",{class:"flex flex-column md:flex-row md:justify-content-between md:align-items-center",style:{"text-align":"center",width:"90%"}},[l("span",{style:{width:"100%"}},"Outbound")],-1),ge=l("div",{class:"flex flex-column md:flex-row md:justify-content-between md:align-items-center",style:{"text-align":"center",width:"90%"}},[l("span",{style:{width:"100%"}},"Batch")],-1),ke=l("div",{class:"flex flex-column md:flex-row md:justify-content-between md:align-items-center",style:{"text-align":"center",width:"90%"}},[l("span",{style:{width:"100%"}},"Department")],-1),xe=l("div",{class:"flex flex-column md:flex-row md:justify-content-between md:align-items-center",style:{"text-align":"center",width:"100%"}},[l("span",{style:{width:"100%"}},"Action")],-1),Se={class:"flex justify-center-between",style:{width:"100%"}},De={class:"field",style:{width:"49%"}},Te=l("label",{for:"name"},"Storage Location",-1),Ce={key:0,class:"p-invalid"},je={class:"field",style:{width:"49%","margin-left":"auto"}},Le=l("label",{for:"desc"},"Description",-1),Ve={key:0,class:"p-invalid"},Fe={class:"flex justify-center-between",style:{width:"100%"}},$e={class:"field",style:{width:"49%"}},Ie=l("label",{for:"plant_id",class:"mb-3"},"Plant",-1),Ee={key:0},Oe={key:1},Ae={key:0,class:"p-invalid"},Be={class:"field",style:{width:"49%","margin-left":"auto"}},Ue=l("label",{for:"is_batch",class:"mb-3"},"Use Batch ?",-1),qe={key:0},Ne={key:1},ze={key:2},Me={key:0,class:"p-invalid"},Re={class:"flex justify-center-between",style:{width:"100%"}},Ye={class:"field",style:{width:"49%"}},Ge=l("label",{for:"is_inbound_release",class:"mb-3"},"Inbound Release",-1),Je={key:0},Pe={key:1},He={key:2},Ke={key:0,class:"p-invalid"},Qe={class:"field",style:{width:"49%","margin-left":"auto"}},We=l("label",{for:"is_outbound_release",class:"mb-3"},"Outbound Release",-1),Xe={key:0},Ze={key:1},ea={key:2},aa={key:0,class:"p-invalid"},ta={class:"flex justify-center-between",style:{width:"100%"}},la={class:"field",style:{width:"49%"}},sa=l("label",{for:"department",class:"mb-3"},"Department",-1),oa={key:0},ia={key:1},na={key:0,class:"p-invalid"},da={class:"flex align-items-center justify-content-center"},ra=l("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem"}},null,-1),ua={key:0},ma={__name:"SlocationPage",setup(ca){const z=le(),w=m(null),g=se(),I=m(null),E=m(null),O=m(null),A=m([]),B=m(""),T=m(!1),j=m(!1),a=m({}),p=m(null),V=m({}),_=m(!1),k=m(null),F=m(null),U=m([]),q=m([]),M=m([{label:"Ya",value:1},{label:"Tidak",value:0}]),R=m([{label:"Ya",value:1},{label:"Tidak",value:0}]),Y=m([{label:"Ya",value:1},{label:"Tidak",value:0}]),C=async i=>{i.page+=1;try{const t=`${D}/api/master/storage_location?page=${i.page}&sortField=${i.sortField}&sortOrder=${i.sortOrder}&search=${k.value!=null?k.value:""}&paginate_count=${i.rows}`,n=await fetch(t,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`}}),s=await n.json();if(F.value=s.data.total,n.ok)A.value=s.data;else throw new Error(s.error||"Failed to fetch data from API")}catch{g.add({severity:"error",summary:"Error",detail:"Failed to fetch data from API",life:5e3})}},J=i=>{var t,n,s;i.target.value?k.value=i.target.value:k.value="",C({page:0,search:k.value,sortField:(t=p.value)==null?void 0:t.sortField,sortOrder:(n=p.value)==null?void 0:n.sortOrder,rows:(s=p.value)==null?void 0:s.rows})};oe(()=>{const i=z.state.permission;i!==null?(w.value=i,I.value=w.value.some(t=>t.name==="create-master"),E.value=w.value.some(t=>t.name==="edit-master"),O.value=w.value.some(t=>t.name==="delete-master")):z.watch(t=>t.permission,t=>{w.value=t,I.value=w.value.some(n=>n.name==="create-master"),E.value=w.value.some(n=>n.name==="edit-master"),O.value=w.value.some(n=>n.name==="delete-master")}),ae()}),ie(async()=>{try{const i=`${D}/api/master/storage_location`,t=await fetch(i,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`}}),n=await t.json();if(t.ok)A.value=n.data,F.value=n.data.total;else throw new Error(n.error||"Failed to fetch data from API");const s=await fetch(`${D}/api/master/department`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`}}),h=await s.json();if(s.ok)U.value=h.data.data;else throw new Error(h.error||"Failed to fetch department data from API");const x=await fetch(`${D}/api/master/plant`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`}}),u=await x.json();if(x.ok)q.value=u.data.data;else throw new Error(u.error||"Failed to fetch plant data from API")}catch{g.add({severity:"error",summary:"Error",detail:"Failed to fetch data from API",life:5e3})}});const P=()=>{a.value={},_.value=!1,T.value=!0,B.value="Add New Storage Location"},H=()=>{T.value=!1,_.value=!1},K=async()=>{var i,t,n;try{const s=await fetch(`${D}/api/master/storage_location/${a.value.id}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify({name:a.value.name,desc:a.value.desc,department_id:a.value.department.id,is_batch:a.value.is_batch.value,plant_id:a.value.plant_id.id,is_inbound_release:a.value.is_inbound_release.value,is_outbound_release:a.value.is_outbound_release.value})}),h=await s.json();if(s.ok)await C({page:0,search:k.value,sortField:(i=p.value)==null?void 0:i.sortField,sortOrder:(t=p.value)==null?void 0:t.sortOrder,rows:(n=p.value)==null?void 0:n.rows}),g.add({severity:"success",summary:"Successful",detail:"Data Storage Location Updated",life:3e3});else throw new Error(h.error||"Failed to update data Storage Location")}catch(s){g.add({severity:"error",summary:"Failed",detail:s,life:5e3})}},Q=async()=>{var i,t,n;try{const s=await fetch(`${D}/api/master/storage_location`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`},body:JSON.stringify({name:a.value.name,desc:a.value.desc,department_id:a.value.department.id,is_batch:a.value.is_batch.value,plant_id:a.value.plant_id.id,is_inbound_release:a.value.is_inbound_release.value,is_outbound_release:a.value.is_outbound_release.value})}),h=await s.json();if(s.ok)await C({page:0,search:k.value,sortField:(i=p.value)==null?void 0:i.sortField,sortOrder:(t=p.value)==null?void 0:t.sortOrder,rows:(n=p.value)==null?void 0:n.rows}),g.add({severity:"success",summary:"Successful",detail:"Data Storage Location Created",life:3e3});else throw new Error(h.error||"Failed to create data Storage Location")}catch(s){g.add({severity:"error",summary:"Failed",detail:s,life:5e3})}},W=()=>{_.value=!0,a.value.name&&a.value.name.trim()&&a.value.desc&&a.value.desc.trim()&&a.value.department&&a.value.department.id!==null&&a.value.plant_id.id!==null&&a.value.is_batch&&a.value.is_batch.value!==null&&a.value.is_outbound_release&&a.value.is_outbound_release.value!==null&&a.value.is_inbound_release&&a.value.is_inbound_release.value!==null&&(a.value.id?K():Q(),T.value=!1,a.value={})},X=i=>{a.value={...i};const t=U.value.find(u=>u.id===a.value.department_id);a.value.department=t;const n=q.value.find(u=>u.id===a.value.plant_id);a.value.plant_id=n;const s=M.value.find(u=>u.value===a.value.is_batch);a.value.is_batch=s;const h=Y.value.find(u=>u.value===a.value.is_outbound_release);a.value.is_outbound_release=h;const x=R.value.find(u=>u.value===a.value.is_inbound_release);a.value.is_inbound_release=x,T.value=!0,B.value="Edit Storage Location"},Z=i=>{a.value=i,j.value=!0},ee=async()=>{var i,t,n;try{const s=await fetch(`${D}/api/master/storage_location/${a.value.id}`,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")}`}}),h=await s.json();if(s.ok)await C({page:0,search:k.value,sortField:(i=p.value)==null?void 0:i.sortField,sortOrder:(t=p.value)==null?void 0:t.sortOrder,rows:(n=p.value)==null?void 0:n.rows}),j.value=!1,a.value={},g.add({severity:"success",summary:"Successful",detail:"Storage Location Deleted",life:3e3});else throw s.status===500&&h.error.includes("Integrity constraint violation")?new Error("Tidak dapat hapus data ini, karena masih digunakan pada data lain"):new Error(h.error||"Failed to delete Storage Location")}catch(s){g.add({severity:"error",summary:"Error",detail:s.message,life:5e3})}},ae=()=>{V.value={global:{value:null,matchMode:ne.CONTAINS}}};return(i,t)=>{const n=S("Toast"),s=S("Button"),h=S("Toolbar"),x=S("InputText"),u=S("Column"),te=S("DataTable"),L=S("Dropdown"),G=S("Dialog");return r(),c("div",de,[l("div",re,[l("div",ue,[d(n),d(h,{class:"mb-4 p-0",style:{border:"none","background-color":"white"}},{start:o(()=>[ce]),end:o(()=>[I.value?(r(),N(s,{key:0,label:"Add New",icon:"pi pi-plus-circle",class:"p-button-primary mr-2",onClick:P})):f("",!0)]),_:1}),d(te,{ref_key:"dt",ref:p,value:A.value.data,lazy:"",filters:V.value,first:i.first,onPage:t[2]||(t[2]=e=>C(e)),last:F.value,loading:i.loading,totalRecords:F.value,dataKey:"id",class:"p-datatable-gridlines",paginator:!0,onSort:t[3]||(t[3]=e=>C(e)),rows:10,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",rowsPerPageOptions:[5,10,25],currentPageReportTemplate:"Showing {first} to {last} of {totalRecords} datamaster",responsiveLayout:"scroll"},{header:o(()=>[l("div",ve,[l("span",me,[_e,d(x,{modelValue:V.value.global.value,"onUpdate:modelValue":t[0]||(t[0]=e=>V.value.global.value=e),placeholder:"Search...",onInput:t[1]||(t[1]=e=>J(e))},null,8,["modelValue"])])])]),default:o(()=>[d(u,{field:"rowIndex",headerStyle:"min-width:5%;",style:{"text-align":"center"}},{header:o(()=>[pe]),body:o(e=>[y(v(e.index+1),1)]),_:1}),d(u,{field:"name",headerStyle:"width:19%;"},{header:o(()=>[he]),body:o(e=>[y(v(e.data.name),1)]),_:1}),d(u,{field:"desc",headerStyle:"width:19%;"},{header:o(()=>[be]),body:o(e=>[y(v(e.data.desc),1)]),_:1}),d(u,{field:"plant",headerStyle:"width:8%;"},{header:o(()=>[fe]),body:o(e=>[y(v(e.data.plant.name),1)]),_:1}),d(u,{field:"is_inbound_release",headerStyle:"width:7%;"},{header:o(()=>[ye]),body:o(e=>[y(v(e.data.is_inbound_release===1?"Ya":"Tidak"),1)]),_:1}),d(u,{field:"is_outbound_release",headerStyle:"width:7%;"},{header:o(()=>[we]),body:o(e=>[y(v(e.data.is_outbound_release===1?"Ya":"Tidak"),1)]),_:1}),d(u,{field:"is_batch",headerStyle:"width:7%;"},{header:o(()=>[ge]),body:o(e=>[y(v(e.data.is_batch===1?"Ya":"Tidak"),1)]),_:1}),d(u,{field:"department",headerStyle:"width:13%;"},{header:o(()=>[ke]),body:o(e=>{var $;return[y(v(($=e.data.department)==null?void 0:$.name),1)]}),_:1}),d(u,{style:{"text-align":"center"},headerStyle:"width:15%;"},{header:o(()=>[xe]),body:o(e=>[E.value?(r(),N(s,{key:0,icon:"pi pi-file-edit",class:"p-button-text p-button-primary mt-2",onClick:$=>X(e.data)},null,8,["onClick"])):f("",!0),O.value?(r(),N(s,{key:1,icon:"pi pi-trash",class:"p-button-text p-button-danger mt-2",onClick:$=>Z(e.data)},null,8,["onClick"])):f("",!0)]),_:1})]),_:1},8,["value","filters","first","last","loading","totalRecords"]),d(G,{visible:T.value,"onUpdate:visible":t[11]||(t[11]=e=>T.value=e),style:{width:"750px"},header:B.value,modal:!0,class:"p-fluid"},{footer:o(()=>[d(s,{label:"Cancel",icon:"pi pi-times",onClick:H,style:{background:"white",color:"blue"}}),d(s,{label:"Save",icon:"pi pi-check",class:"p-button-primary",onClick:W})]),default:o(()=>[l("div",Se,[l("div",De,[Te,d(x,{id:"name",modelValue:a.value.name,"onUpdate:modelValue":t[4]||(t[4]=e=>a.value.name=e),modelModifiers:{trim:!0},required:"true",autofocus:"",class:b({"p-invalid":_.value&&!a.value.name})},null,8,["modelValue","class"]),_.value&&!a.value.name?(r(),c("small",Ce,"Storage Location is required.")):f("",!0)]),l("div",je,[Le,d(x,{id:"desc",modelValue:a.value.desc,"onUpdate:modelValue":t[5]||(t[5]=e=>a.value.desc=e),modelModifiers:{trim:!0},required:"true",autofocus:"",class:b({"p-invalid":_.value&&!a.value.desc})},null,8,["modelValue","class"]),_.value&&!a.value.desc?(r(),c("small",Ve,"Description is required.")):f("",!0)])]),l("div",Fe,[l("div",$e,[Ie,d(L,{id:"plant_id",modelValue:a.value.plant_id,"onUpdate:modelValue":t[6]||(t[6]=e=>a.value.plant_id=e),options:q.value,optionLabel:"name",placeholder:"Select a plant",class:b({"p-invalid":_.value&&!a.value.plant_id}),required:"true"},{value:o(e=>[e.value&&e.value.id?(r(),c("div",Ee,v(e.value.name),1)):(r(),c("span",Oe,v(e.placeholder),1))]),_:1},8,["modelValue","options","class"]),_.value&&!a.value.plant_id?(r(),c("small",Ae,"Plant is required.")):f("",!0)]),l("div",Be,[Ue,d(L,{id:"is_batch",modelValue:a.value.is_batch,"onUpdate:modelValue":t[7]||(t[7]=e=>a.value.is_batch=e),options:M.value,optionLabel:"label",placeholder:"Select a batch",class:b({"p-invalid":_.value&&!a.value.is_batch}),required:"true"},{value:o(e=>[e.value&&e.value.value?(r(),c("div",qe,[l("span",{class:b("product-badge status-"+e.value.value)},v(e.value.label),3)])):e.value&&!e.value.value?(r(),c("div",Ne,[l("span",{class:b("product-badge status-"+e.value.label.toLowerCase())},v(e.value.label),3)])):(r(),c("span",ze,v(e.placeholder),1))]),_:1},8,["modelValue","options","class"]),_.value&&!a.value.is_batch?(r(),c("small",Me,"Select batch status is required.")):f("",!0)])]),l("div",Re,[l("div",Ye,[Ge,d(L,{id:"is_inbound_release",modelValue:a.value.is_inbound_release,"onUpdate:modelValue":t[8]||(t[8]=e=>a.value.is_inbound_release=e),options:R.value,optionLabel:"label",placeholder:"Select inbound",class:b({"p-invalid":_.value&&!a.value.is_inbound_release}),required:"true"},{value:o(e=>[e.value&&e.value.value?(r(),c("div",Je,[l("span",{class:b("product-badge status-"+e.value.value)},v(e.value.label),3)])):e.value&&!e.value.value?(r(),c("div",Pe,[l("span",{class:b("product-badge status-"+e.value.label.toLowerCase())},v(e.value.label),3)])):(r(),c("span",He,v(e.placeholder),1))]),_:1},8,["modelValue","options","class"]),_.value&&!a.value.is_inbound_release?(r(),c("small",Ke,"Select Inbound status is required.")):f("",!0)]),l("div",Qe,[We,d(L,{id:"is_outbound_release",modelValue:a.value.is_outbound_release,"onUpdate:modelValue":t[9]||(t[9]=e=>a.value.is_outbound_release=e),options:Y.value,optionLabel:"label",placeholder:"Select a outbound",class:b({"p-invalid":_.value&&!a.value.is_outbound_release}),required:"true"},{value:o(e=>[e.value&&e.value.value?(r(),c("div",Xe,[l("span",{class:b("product-badge status-"+e.value.value)},v(e.value.label),3)])):e.value&&!e.value.value?(r(),c("div",Ze,[l("span",{class:b("product-badge status-"+e.value.label.toLowerCase())},v(e.value.label),3)])):(r(),c("span",ea,v(e.placeholder),1))]),_:1},8,["modelValue","options","class"]),_.value&&!a.value.is_outbound_release?(r(),c("small",aa,"Select Outbound status is required.")):f("",!0)])]),l("div",ta,[l("div",la,[sa,d(L,{id:"department",modelValue:a.value.department,"onUpdate:modelValue":t[10]||(t[10]=e=>a.value.department=e),options:U.value,optionLabel:"name",placeholder:"Select a Department",class:b({"p-invalid":_.value&&!a.value.department}),required:"true"},{value:o(e=>[e.value&&e.value.id?(r(),c("div",oa,v(e.value.name),1)):(r(),c("span",ia,v(e.placeholder),1))]),_:1},8,["modelValue","options","class"]),_.value&&!a.value.department?(r(),c("small",na,"Department is required.")):f("",!0)])])]),_:1},8,["visible","header"]),d(G,{visible:j.value,"onUpdate:visible":t[13]||(t[13]=e=>j.value=e),style:{width:"450px"},header:"Confirm",modal:!0},{footer:o(()=>[d(s,{label:"No",icon:"pi pi-times",style:{background:"white",color:"red",borderColor:"red"},onClick:t[12]||(t[12]=e=>j.value=!1)}),d(s,{label:"Yes",icon:"pi pi-check",class:"p-button-primary",onClick:ee})]),default:o(()=>[l("div",da,[ra,a.value?(r(),c("span",ua,[y("Are you sure you want to delete "),l("b",null,v(a.value.name),1),y("?")])):f("",!0)])]),_:1},8,["visible"])])])])}}};export{ma as default};
